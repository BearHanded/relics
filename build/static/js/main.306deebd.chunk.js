(this["webpackJsonprelics-app"]=this["webpackJsonprelics-app"]||[]).push([[0],{13:function(e,t,a){},14:function(e,t,a){},15:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(7),i=a.n(c),o=(a(13),a(1)),s=a(2),l=a(3),u=a(4),h=(a(14),a(5)),m=function e(){Object(o.a)(this,e),this.currencies=new v,this.generators=new f,this.journalState=new g,this.saveTime=new Date},v=function e(){Object(o.a)(this,e),this.relics=0},f=function e(){Object(o.a)(this,e),this.relicGenerator=0},g=function e(){Object(o.a)(this,e),this.entries=["Where am I?"]};function d(){return!!localStorage.getItem("RelicsSave")}function k(){var e=localStorage.getItem("RelicsSave"),t=e?JSON.parse(atob(e)):null;return Object(h.a)({},new m,{},t)}function S(){return new m}function p(e){localStorage.setItem("RelicsSave",btoa(JSON.stringify(e)))}var b=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"getStory",value:function(){return"These dusty relics are probably worth something!"}},{key:"render",value:function(){return n.createElement("h1",null,this.getStory())}}]),a}(n.Component),E=function(){function e(){Object(o.a)(this,e),this.updateClock=!0}return Object(s.a)(e,[{key:"commitTransaction",value:function(e,t){if(this.isValidPurchase(e,t)){var a=this.getCost(e,t);e.currencies.relics-=a,e.generators.relicGenerator+=t}return e}},{key:"isValidPurchase",value:function(e,t){var a=this.getCost(e,t);return e.currencies.relics>=a}},{key:"getCost",value:function(e,t){for(var a=0,n=e.generators.relicGenerator||0,r=0;r<t;r++)a+=25+10*n,n++;return a}}]),e}(),j=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).studentPurchasable=new E,e}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.gameState,r=t.onAddCurrency,c=t.onPurchase;return n.createElement("div",null,n.createElement("button",{onClick:function(){return r("relics",1)}},"Look for relics"),n.createElement("br",null),n.createElement("p",null,"You have ",a.currencies.relics.toFixed()," relics"),n.createElement("br",null),n.createElement("div",null,"Hire some students to dust off relics for you. They work for relics. (You have ",a.generators.relicGenerator,")",n.createElement("button",{onClick:function(){return c(1,e.studentPurchasable)}},this.studentPurchasable.getCost(a,1))))}}]),a}(n.Component),y={light:{themeClass:"app app--light"},dark:{themeClass:"app app--dark"}},O=r.a.createContext({theme:y.dark,toggleTheme:function(){}}),C=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.onSave,a=e.onClearSave;return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return t()}},"Save"),r.a.createElement("button",{onClick:function(){return a()}},"Clear Save")),r.a.createElement("div",null,r.a.createElement(O.Consumer,null,(function(e){e.theme;var t=e.toggleTheme;return r.a.createElement("button",{onClick:function(){return t()}},"Toggle Dark Mode")}))),r.a.createElement("p",null,"Last Saved at $",this.props.gameState.saveTime?this.props.gameState.saveTime.toString():""))}}]),a}(r.a.Component);function T(e,t){return e.journalState.entries.push(t),e.journalState.entries.length>=25&&e.journalState.entries.shift(),e}function w(e){var t=Math.floor(100*Math.random()+1);console.log(t),t>=95&&T(e,"The wind blows across the dusty plain"),10<=t&&t<=15&&(T(e,"A stranger shuffles up and hands something to you: +100 Relics!"),e.currencies.relics+=100)}var I=function(){function e(t,a){Object(o.a)(this,e),this.saveClockId=void 0,this.resourceClockId=void 0,this.gameState=void 0,this.tickRatio=void 0,this.emitTick=void 0,this.maxTicks=void 0,this.tickNumber=0,this.saveClockId=setInterval((function(){return p(t)}),3e4),this.gameState=t,this.updateState(t),this.tickRatio=.05,this.maxTicks=100,this.emitTick=a}return Object(s.a)(e,[{key:"tick",value:function(){var e=Object(h.a)({},this.gameState);this.gameState.generators.relicGenerator&&(e.currencies.relics+=this.gameState.generators.relicGenerator*this.tickRatio),this.tickNumber>=this.maxTicks&&(w(e),this.tickNumber=1),this.gameState=e,this.emitTick(e),this.tickNumber++}},{key:"updateState",value:function(e){var t=this;clearInterval(this.resourceClockId),this.resourceClockId=setInterval((function(){return t.tick()}),50)}},{key:"clearClock",value:function(){clearInterval(this.resourceClockId),clearInterval(this.saveClockId)}}]),e}(),P=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"getStory",value:function(){return"These dusty relics are probably worth something!"}},{key:"render",value:function(){var e=this.props,t=e.journalState,a=e.clearLog,r=t.entries.map((function(e){return n.createElement("p",null,e)}));return n.createElement("div",null,n.createElement("button",{onClick:function(){return a()}},"Clear Log"),n.createElement("div",null,r))}}]),a}(n.Component),N=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.onChangePanel;return r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return e("GENERATORS")}},"The Fields"),r.a.createElement("button",{onClick:function(){return e("SETTINGS")}},"Settings"))}}]),a}(r.a.Component),R=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).clock=void 0,e.state={gameState:d()?k():S(),activePanel:"GENERATORS"},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.clock=new I(this.state.gameState,(function(t){return e.onTick(t)})),this.setState({activePanel:"GENERATORS"})}},{key:"onTick",value:function(e){this.setState({gameState:e})}},{key:"addCurrency",value:function(e,t){var a=Object(h.a)({},this.state.gameState);a.currencies.relics+=t,T(a,"You dust off some potsherds."),this.setState({gameState:a})}},{key:"makePurchase",value:function(e,t){var a=Object(h.a)({},this.state.gameState);a=t.commitTransaction(a,e),this.setState({gameState:a}),t.updateClock&&this.clock.updateState(a)}},{key:"clearLog",value:function(){this.state.gameState.journalState.entries=[]}},{key:"changeActivePanel",value:function(e){this.setState({activePanel:e})}},{key:"save",value:function(){var e=Object(h.a)({},this.state.gameState);e.saveTime=new Date,this.setState({gameState:e}),p(e)}},{key:"clearSave",value:function(){console.log("CLEARING SAVE"),this.clock.clearClock();var e=S();e.saveTime=new Date,this.setState({gameState:e}),p(e),location.reload()}},{key:"render",value:function(){var e,t=this;switch(this.state.activePanel){case"SETTINGS":e=n.createElement(C,{gameState:this.state.gameState,onSave:function(){return t.save()},onClearSave:function(){return t.clearSave()}});break;case"GENERATORS":default:e=n.createElement(j,{gameState:this.state.gameState,onAddCurrency:function(e,a){return t.addCurrency(e,a)},onPurchase:function(e,a){return t.makePurchase(e,a)}})}return n.createElement("div",null,n.createElement("header",{className:"app-header"},n.createElement(b,{gameState:this.state.gameState})),n.createElement(N,{onChangePanel:function(e){return t.changeActivePanel(e)}}),n.createElement("div",{className:"core-panel__flex"},e,n.createElement("div",null,n.createElement(P,{clearLog:function(){return t.clearLog()},journalState:this.state.gameState.journalState}))))}}]),a}(n.Component),A=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state=void 0,n.toggleTheme=void 0,n.toggleTheme=function(){n.setState((function(e){return{theme:e.theme===y.dark?y.light:y.dark}}))},n.state={theme:y.light,toggleTheme:n.toggleTheme},n}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement(O.Provider,{value:this.state},r.a.createElement("div",{className:this.state.theme.themeClass},r.a.createElement(R,null)))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,a){e.exports=a(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.306deebd.chunk.js.map